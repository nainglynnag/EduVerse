<!-- Create Course Content -->
<div id="createCourseContent">
  <div class="max-w-4xl mx-auto">
    <div class="mb-6">
      <h2 class="text-2xl font-bold text-gray-800">
        Create New Course
      </h2>
      <p class="text-gray-600">
        Fill in the details to create your new course
      </p>
    </div>

    <form id="createCourseForm" class="space-y-8" action="/instructor/courses/create" method="POST">
      <!-- Basic Information -->
      <div class="bg-white rounded-2xl p-6 shadow-lg">
        <h3 class="text-lg font-bold text-gray-800 mb-4">
          Basic Information
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Course Title *</label
            >
            <input
              type="text"
              id="courseTitle"
              name="courseTitle"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
              placeholder="Enter course title"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Category *</label
            >
            <select
              id="courseCategory"
              name="courseCategory"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
            >
              <option value="">Select category</option>
              <% if (categories && categories.length > 0) { %>
                <% categories.forEach(category => { %>
                  <option value="<%= category.id %>" title="<%= category.description || '' %>">
                    <%= category.display_name || category.title || category.name %>
                  </option>
                <% }); %>
              <% } %>
            </select>
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Short Description *</label
            >
            <textarea
              id="courseDescription"
              name="courseDescription"
              required
              rows="3"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
              placeholder="Brief description of your course"
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Course Details -->
      <div class="bg-white rounded-2xl p-6 shadow-lg">
        <h3 class="text-lg font-bold text-gray-800 mb-4">
          Course Details
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Price ($) *</label
            >
            <input
              type="number"
              id="coursePrice"
              name="coursePrice"
              required
              min="0"
              step="0.01"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
              placeholder="0.00"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Duration (hours) *</label
            >
            <input
              type="number"
              id="courseDuration"
              name="courseDuration"
              required
              min="1"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
              placeholder="10"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Difficulty Level *</label
            >
            <select
              id="courseDifficulty"
              name="courseDifficulty"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
            >
              <option value="">Select level</option>
              <% if (difficultyLevels && difficultyLevels.length > 0) { %>
                <% difficultyLevels.forEach(level => { %>
                  <option value="<%= level.id %>" title="<%= level.description || '' %>">
                    <%= level.name %>
                  </option>
                <% }); %>
              <% } %>
            </select>
          </div>
        </div>
      </div>

      <!-- Course Content -->
      <div class="bg-white rounded-2xl p-6 shadow-lg">
        <h3 class="text-lg font-bold text-gray-800 mb-4">
          Course Content
        </h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Learning Objectives</label
            >
            <textarea
              id="courseObjectives"
              name="courseObjectives"
              rows="4"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
              placeholder="What will students learn from this course?"
            ></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Prerequisites</label
            >
            <textarea
              id="coursePrerequisites"
              name="coursePrerequisites"
              rows="3"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
              placeholder="What should students know before taking this course?"
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Course Lessons -->
      <div class="bg-white rounded-2xl p-6 shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-800">
            Course Lessons
          </h3>
          <button
            type="button"
            onclick="addLesson()"
            class="bg-purple-100 text-purple-600 px-4 py-2 rounded-lg hover:bg-purple-200 transition-colors flex items-center space-x-2"
          >
            <svg
              class="w-4 h-4"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                fill-rule="evenodd"
                d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                clip-rule="evenodd"
              />
            </svg>
            <span>Add Lesson</span>
          </button>
        </div>
        <div id="lessonsContainer" class="space-y-4">
          <!-- Lessons will be added dynamically -->
        </div>
      </div>

      <!-- Form Actions -->
      <div class="flex justify-end space-x-4">
        <a
          href="/instructor/courses"
          class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
        >
          Cancel
        </a>
        <button
          type="button"
          onclick="saveDraft()"
          class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
        >
          Save as Draft
        </button>
        <button
          type="submit"
          class="px-6 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all"
        >
          Publish Course
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  let lessonCounter = 0;

  // Categories and difficulty levels are now loaded server-side from database

  // Create course form functions
  function addLesson() {
    lessonCounter++;
    const lessonsContainer = document.getElementById("lessonsContainer");
    const lessonDiv = document.createElement("div");
    lessonDiv.className = "border border-gray-200 rounded-lg p-4";
    lessonDiv.innerHTML = `
            <div class="flex items-center justify-between mb-4">
                <h4 class="font-medium text-gray-800">Lesson ${lessonCounter}</h4>
                <button type="button" onclick="removeLesson(this)" class="text-red-600 hover:text-red-700">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Lesson Title</label>
                    <input type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Enter lesson title">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Duration (minutes)</label>
                    <input type="number" min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="15">
                </div>
            </div>
            <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Lesson Description</label>
                <textarea rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Brief description of this lesson"></textarea>
            </div>
        `;
    lessonsContainer.appendChild(lessonDiv);
  }

  function removeLesson(button) {
    button.closest(".border").remove();
  }

  function resetCreateForm() {
    document.getElementById("createCourseForm").reset();
    document.getElementById("lessonsContainer").innerHTML = "";
    lessonCounter = 0;
    addLesson(); // Add first lesson by default
  }

  function saveDraft() {
    alert("Course saved as draft! You can continue editing later.");
  }


  // Initialize
  document.addEventListener('DOMContentLoaded', function() {
    addLesson(); // Add first lesson by default
  });
</script>
